// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  engineType = "library"
  binaryTargets = ["native", "windows"]
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL_PROD")
}

enum RequestType {
  get
  post
}

enum LoginStatus {
  succeed
  failed
}

model User {
  id          Int         @id @default(autoincrement())
  steamID     String      @unique
  nickname    String
  cookie      String
  refreshToken String
  loginStatus LoginStatus
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  proxies UserProxy[] // relationship
}

model Proxy {
  id          Int         @id @default(autoincrement())
  configName  String      @unique
  proxyLink   String
  targetLink  String
  requestType RequestType
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  users UserProxy[] // relationship
}

model UserProxy {
  userId  Int
  proxyId Int

  user  User  @relation(fields: [userId], references: [id], onDelete: Cascade)
  proxy Proxy @relation(fields: [proxyId], references: [id], onDelete: Cascade)

  @@id([userId, proxyId]) // 联合主键
}
